<html>
   <head>
      <link rel="stylesheet" type="text/css" href="reset.css" />
      <link rel="stylesheet" type="text/css" href="app.css" />
      <script src="jquery-1.6.3.min.js"></script>

   </head>
   <body>
      <div id="rejects">
         <h1>Eliminated</h1>

         <li id="rejectlist">
         <ul>reject</ul>
         </li>
      </div>
      <div id="numbers">
         <h1>Tickets In Play</h1>
      </div>
      <div id="debug">
      </div>
      <script>
         var resizetime = 1000;


         function resizeSmoothly(element,count) {
            var units = "%";
            var n = $('.n');
            var winheight = window.innerHeight;
            var was = n.css('font-size');
            var pxsize = 20;
            $('#marker').css('top',winheight);

            n.css('font-size',String(pxsize) + units);
            var gotsmaller = false;
            while(true) {
               var lineheight = n.height();
               var diff = (lineheight * count + lineheight * 2) - winheight;
               //      alert(lineheight);
               //      alert(diff + " " + pxsize);
               if(diff == 0) {
                  break;
                  } else if(diff < 0) {
                  if(gotsmaller) {
                     break;
                  }
                  pxsize += 1;
                  } else {
                  pxsize -= 1;
                  gotsmaller = true;
               }
               n.css('font-size',String(pxsize) + units);
            }
            n.css('font-size',was);

            //animate(1,pxsize);
            var size = String(pxsize) + units;
            n.animate({fontSize:size},resizetime);
            //n.css('font-size',size);
         }

         var count = 30;
         var columns = 4;

         var html = "<ul id='from'>";
            for(var i=0;i<count;++i) {
               html += "<li id='n" + i + "' class='n'>023 329 " + i + "</li>"
            }
            html += "</ul>"
         $('#numbers').append(html);

         resizeSmoothly(count);

         function removeOne() {
            var elements = $('#from').children();
            var index = Math.floor(Math.random() * elements.size());
            var el = $($('.n')[index]);
            count = count - 1;

            //el.html("remove");
            var divid = 'reject' + el.attr('id');
            var newel = "<li id='" + divid + "'>" + el.html() + "</li>";
            $('#numbers').append(newel);
            newel = $("#" + divid);
            var pos = el.offset();
            var rejectpos = $('#rejectlist').offset();
            newel.css({position: 'absolute',
               fontSize: el.css('font-size'),
               marginLeft: 0, marginTop: 0,
               top: pos.top, left: pos.left });
            var cursize = el.css('font-size');
            cursize = cursize.substr(0,cursize.length-2);

            el.html("&nbsp;");

            newel.animate({fontSize:String(cursize * 2) + "px"},resizetime).animate({fontSize:String(cursize) + 'px', left: rejectpos.left, top: rejectpos.top + $('#rejectlist').height()},{duration: resizetime, complete: function() { el.remove(); resizeSmoothly(count); newel.appendTo($('#rejectlist')); newel.css({position: 'relative', top: 0, left: 0}); }});
            el.animate({fontSize:String(cursize * 2) + "px"},resizetime).animate({fontSize:"0"},resizetime);
            //resizeSmoothly(count);
         }

         function doremove() {
            setTimeout(function() {
               removeOne();
               if(count == 1) {
                  return;
               }
               doremove();
            },resizetime * 4);
         }
         doremove();
         //removeOne();

      </script>
   </body>
</html>
